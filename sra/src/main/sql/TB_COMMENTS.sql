CREATE TABLE COMMENTS (
    COMMENT_ID NUMBER GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) PRIMARY KEY,
    POST_ID NUMBER NOT NULL,
    USER_ID NUMBER NOT NULL,
    PARENT_COMMENT_ID NUMBER,
    CONTENT VARCHAR2(500) NOT NULL,
    CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    UPDATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
    FOREIGN KEY (POST_ID) REFERENCES POSTS(POST_ID) ON DELETE CASCADE,
    FOREIGN KEY (USER_ID) REFERENCES USERS(USER_ID) ON DELETE CASCADE,
    FOREIGN KEY (PARENT_COMMENT_ID) REFERENCES COMMENTS(COMMENT_ID) ON DELETE CASCADE
);

CREATE INDEX IDX_COMMENTS_POST_ID ON COMMENTS (POST_ID);
CREATE INDEX IDX_COMMENTS_USER_ID ON COMMENTS (USER_ID);
CREATE INDEX IDX_COMMENTS_PARENT_ID ON COMMENTS (PARENT_COMMENT_ID);

-- 6. 댓글 테이블 (TB_COMMENTS) 주석 추가
COMMENT ON TABLE TB_COMMENTS IS '게시글에 대한 댓글 정보를 저장하는 테이블';
COMMENT ON COLUMN TB_COMMENTS.COMMENT_ID IS '댓글 고유 ID (기본 키)';
COMMENT ON COLUMN TB_COMMENTS.POST_ID IS '댓글이 달린 게시글 ID (TB_POSTS 참조)';
COMMENT ON COLUMN TB_COMMENTS.USER_ID IS '댓글 작성자 ID (TB_USERS 참조)';
COMMENT ON COLUMN TB_COMMENTS.PARENT_COMMENT_ID IS '부모 댓글 ID (대댓글인 경우, TB_COMMENTS 참조)';
COMMENT ON COLUMN TB_COMMENTS.CONTENT IS '댓글 내용';
COMMENT ON COLUMN TB_COMMENTS.CREATED_AT IS '댓글 생성일시';
COMMENT ON COLUMN TB_COMMENTS.UPDATED_AT IS '댓글 수정일시';